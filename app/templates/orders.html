{% extends "base.html" %}

{% block content %}
<div class="hero-panel">
  <div>
    <div class="eyebrow mb-2">Order History</div>
    <h1 class="mb-2">Track every delivery</h1>
    <p class="muted mb-0">Review your {{ orders|length }} {{ 'order' if orders|length == 1 else 'orders' }} below.</p>
  </div>
  <div class="text-right">
    <div class="muted text-uppercase small">Need to add more?</div>
    <a href="{{ url_for('cart.cart', user_id=user_id) }}" class="btn btn-light btn-sm text-dark mt-2">Return to Cart</a>
  </div>
</div>

{% if orders %}
  {% for order in orders %}
    {% set status_label = 'Fulfilled' if order.is_fulfilled else (order.status|capitalize) %}
    {% set pill_class = 'success' if order.is_fulfilled else ('info' if order.status == 'partial' else 'warning') %}
    <div class="order-card">
      <div class="d-flex justify-content-between align-items-start flex-wrap">
        <div>
          <div class="text-uppercase small text-muted mb-1">Order #{{ order.id }}</div>
          <h4 class="mb-2">${{ "{:,.2f}".format(order.total_amount) }}</h4>
          <div class="order-meta mb-2">
            <span>Placed {{ order.created_at | friendly_datetime }}</span>
            <span>{{ order.item_count }} {{ 'item' if order.item_count == 1 else 'items' }}</span>
          </div>
        </div>
        <div class="text-right">
          <span class="status-pill {{ pill_class }}">{{ status_label }}</span>
          <div class="mt-3">
            <a href="{{ url_for('cart.order_detail', user_id=user_id, order_id=order.id) }}" class="btn btn-primary btn-sm">View Details</a>
          </div>
        </div>
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="card card-lift text-center p-5">
    <h4>No orders yet.</h4>
    <p class="text-muted mb-4">Return to your cart to place your first order.</p>
    <a href="{{ url_for('cart.cart', user_id=user_id) }}" class="btn btn-primary">Go to Cart</a>
  </div>
{% endif %}
{% endblock %}
